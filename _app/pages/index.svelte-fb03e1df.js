import{S as X,i as Y,s as Z,e as d,k as V,t as $,c as f,n as z,a as v,g as j,d as r,b as m,f as q,H as a,h as O,J as x,K as ae,I as P,A as se,L as ne,M as C,j as le,N as re,m as ie,O as oe,o as ce,x as ue,u as me,v as de}from"../chunks/vendor-40fbc9ca.js";function ee(E){let c,i,u,t,o,b=E[0].name+"",n,l,e,s,h=E[0].startTime.toString()+"",g,T,I,D,w,y=E[0].link+"",R,M;return{c(){c=d("br"),i=V(),u=d("div"),t=d("p"),o=d("b"),n=$(b),l=V(),e=d("br"),s=V(),g=$(h),T=V(),I=d("br"),D=V(),w=d("a"),R=$(y),this.h()},l(_){c=f(_,"BR",{}),i=z(_),u=f(_,"DIV",{class:!0});var k=v(u);t=f(k,"P",{class:!0});var p=v(t);o=f(p,"B",{});var B=v(o);n=j(B,b),B.forEach(r),l=z(p),e=f(p,"BR",{}),s=z(p),g=j(p,h),T=z(p),I=f(p,"BR",{}),D=z(p),w=f(p,"A",{href:!0});var N=v(w);R=j(N,y),N.forEach(r),p.forEach(r),k.forEach(r),this.h()},h(){m(w,"href",M=E[0].link),m(t,"class","title is-6"),m(u,"class","box is-shadowless has-text-centered m-0")},m(_,k){q(_,c,k),q(_,i,k),q(_,u,k),a(u,t),a(t,o),a(o,n),a(t,l),a(t,e),a(t,s),a(t,g),a(t,T),a(t,I),a(t,D),a(t,w),a(w,R)},p(_,k){k&1&&b!==(b=_[0].name+"")&&O(n,b),k&1&&h!==(h=_[0].startTime.toString()+"")&&O(g,h),k&1&&y!==(y=_[0].link+"")&&O(R,y),k&1&&M!==(M=_[0].link)&&m(w,"href",M)},d(_){_&&r(c),_&&r(i),_&&r(u)}}}function fe(E){let c,i,u,t,o,b,n=E[0]&&ee(E);return{c(){c=d("main"),i=d("button"),u=$("Get A Random Meeting"),t=V(),n&&n.c(),this.h()},l(l){c=f(l,"MAIN",{});var e=v(c);i=f(e,"BUTTON",{class:!0});var s=v(i);u=j(s,"Get A Random Meeting"),s.forEach(r),t=z(e),n&&n.l(e),e.forEach(r),this.h()},h(){m(i,"class","button is-fullwidth svelte-1cf5j7t"),i.disabled=E[1],x(i,"is-loading",E[1])},m(l,e){q(l,c,e),a(c,i),a(i,u),a(c,t),n&&n.m(c,null),o||(b=ae(i,"click",E[2]),o=!0)},p(l,[e]){e&2&&(i.disabled=l[1]),e&2&&x(i,"is-loading",l[1]),l[0]?n?n.p(l,e):(n=ee(l),n.c(),n.m(c,null)):n&&(n.d(1),n=null)},i:P,o:P,d(l){l&&r(c),n&&n.d(),o=!1,b()}}}function he(E,c,i){let u,t,o=[],b=!1;class n{constructor(s){this.name=s.meeting_name,this.startTime=this.getAdjustedStartTime(s),this.link=s.comments}getAdjustedStartTime(s){const h=parseInt(s.weekday_tinyint)===1?7:parseInt(s.weekday_tinyint)-1;let g=C().tz(s.time_zone||"UTC",!0).set({hour:parseInt(s.start_time.split(":")[0]),minute:parseInt(s.start_time.split(":")[1]),second:0}).isoWeekday(h);return g=g.clone().tz(C.tz.guess()),C.tz(C.tz.guess())>g&&g.add(1,"weeks"),g}}se(()=>{i(1,b=!0),ne("https://bmlt.virtual-na.org/main_server/client_interface/jsonp/?switcher=GetSearchResults&data_field_key=weekday_tinyint,start_time,time_zone,meeting_name,comments").then(e=>e.json()).then(e=>{let s=[];if(e)for(const h of e)s.push(new n(h));return s}).then(e=>{if(t=[],!e)return;const s=e.length<3?e.length:3;let h=30;for(;;){for(const g of e.filter(T=>!t.includes(T))){const T=C.tz(C.tz.guess()),I=g.startTime.diff(T,"minutes");if(I>=-10&&I<=h&&(t.push(g),t.length>=s&&h>30))break}if(t.length>=s||h>1440)break;h+=15}}).then(()=>l()).then(()=>i(1,b=!1)).catch(e=>console.log("parsing failed",e))});function l(){console.log("hi"),console.log(o.length),console.log(t.length),o.length==t.length&&(o.length>1?o=[o.pop()]:o=[]);const e=t.filter(s=>!o.includes(s));i(0,u=e[Math.floor(Math.random()*e.length)]),o.push(u),console.log(u.name),console.log(u.startTime.toString()),console.log(u.link)}return[u,b,l]}class _e extends X{constructor(c){super();Y(this,c,he,fe,Z,{})}}function pe(E){let c,i,u,t,o,b,n,l,e,s,h,g,T,I,D,w,y,R,M,_,k,p,B,N;return I=new _e({}),{c(){c=d("link"),i=d("link"),u=d("meta"),t=d("meta"),o=d("script"),n=V(),l=d("section"),e=d("div"),s=d("div"),h=d("h4"),g=$("Random Virtual Meeting"),T=V(),le(I.$$.fragment),D=V(),w=d("div"),y=d("div"),R=d("p"),M=d("a"),_=$("Ideas?"),k=$(`
                \u2022 Meetings sourced from
                `),p=d("a"),B=$("virtual-na.org"),this.h()},l(S){const A=re('[data-svelte="svelte-1q7c1ll"]',document.head);c=f(A,"LINK",{rel:!0,href:!0}),i=f(A,"LINK",{rel:!0,href:!0}),u=f(A,"META",{name:!0,content:!0}),t=f(A,"META",{name:!0,content:!0}),o=f(A,"SCRIPT",{src:!0,"data-auto-a11y":!0});var te=v(o);te.forEach(r),A.forEach(r),n=z(S),l=f(S,"SECTION",{class:!0});var L=v(l);e=f(L,"DIV",{class:!0});var U=v(e);s=f(U,"DIV",{class:!0});var G=v(s);h=f(G,"H4",{class:!0});var H=v(h);g=j(H,"Random Virtual Meeting"),H.forEach(r),T=z(G),ie(I.$$.fragment,G),G.forEach(r),U.forEach(r),D=z(L),w=f(L,"DIV",{class:!0});var J=v(w);y=f(J,"DIV",{class:!0});var W=v(y);R=f(W,"P",{});var K=v(R);M=f(K,"A",{href:!0,target:!0});var F=v(M);_=j(F,"Ideas?"),F.forEach(r),k=j(K,`
                \u2022 Meetings sourced from
                `),p=f(K,"A",{href:!0,target:!0});var Q=v(p);B=j(Q,"virtual-na.org"),Q.forEach(r),K.forEach(r),W.forEach(r),J.forEach(r),L.forEach(r),this.h()},h(){m(c,"rel","manifest"),m(c,"href","manifest.json"),m(i,"rel","apple-touch-icon"),m(i,"href","apple-icon-180.png"),m(u,"name","mobile-web-app-capable"),m(u,"content","yes"),m(t,"name","apple-mobile-web-app-capable"),m(t,"content","yes"),document.title="Random Virtual Meeting",oe(o.src,b="https://use.fontawesome.com/releases/v5.15.4/js/all.js")||m(o,"src",b),m(o,"data-auto-a11y","true"),m(h,"class","title is-4 has-text-centered"),m(s,"class","card p-5"),m(e,"class","container"),m(M,"href","https://github.com/bmlt-enabled/randomvm/issues"),m(M,"target","_blank"),m(p,"href","https://virtual-na.org/meetings"),m(p,"target","_blank"),m(y,"class","card p-5 mt-5 has-text-centered"),m(w,"class","container"),m(l,"class","section p-5")},m(S,A){a(document.head,c),a(document.head,i),a(document.head,u),a(document.head,t),a(document.head,o),q(S,n,A),q(S,l,A),a(l,e),a(e,s),a(s,h),a(h,g),a(s,T),ce(I,s,null),a(l,D),a(l,w),a(w,y),a(y,R),a(R,M),a(M,_),a(R,k),a(R,p),a(p,B),N=!0},p:P,i(S){N||(ue(I.$$.fragment,S),N=!0)},o(S){me(I.$$.fragment,S),N=!1},d(S){r(c),r(i),r(u),r(t),r(o),S&&r(n),S&&r(l),de(I)}}}class ve extends X{constructor(c){super();Y(this,c,null,pe,Z,{})}}export{ve as default};
