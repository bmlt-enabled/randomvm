import{S as X,i as Y,s as Z,e as d,k as j,t as D,c as f,n as z,a as M,g as N,d as n,b as u,f as C,H as e,h as O,J as x,K as se,I as P,L as $,A as ae,M as ne,j as re,N as le,m as ie,O as oe,o as ce,x as ue,u as me,v as de}from"../chunks/vendor-06f73bce.js";function ee(R){let c,r,h,s,l,w=R[0].name+"",a,i,m,b,I=R[0].startTime.toString()+"",S,_,t,p,o,k=R[0].link+"",E,y;return{c(){c=d("br"),r=j(),h=d("div"),s=d("p"),l=d("b"),a=D(w),i=j(),m=d("br"),b=j(),S=D(I),_=j(),t=d("br"),p=j(),o=d("a"),E=D(k),this.h()},l(g){c=f(g,"BR",{}),r=z(g),h=f(g,"DIV",{class:!0});var T=M(h);s=f(T,"P",{class:!0});var v=M(s);l=f(v,"B",{});var q=M(l);a=N(q,w),q.forEach(n),i=z(v),m=f(v,"BR",{}),b=z(v),S=N(v,I),_=z(v),t=f(v,"BR",{}),p=z(v),o=f(v,"A",{href:!0});var B=M(o);E=N(B,k),B.forEach(n),v.forEach(n),T.forEach(n),this.h()},h(){u(o,"href",y=R[0].link),u(s,"class","title is-6"),u(h,"class","box is-shadowless has-text-centered m-0")},m(g,T){C(g,c,T),C(g,r,T),C(g,h,T),e(h,s),e(s,l),e(l,a),e(s,i),e(s,m),e(s,b),e(s,S),e(s,_),e(s,t),e(s,p),e(s,o),e(o,E)},p(g,T){T&1&&w!==(w=g[0].name+"")&&O(a,w),T&1&&I!==(I=g[0].startTime.toString()+"")&&O(S,I),T&1&&k!==(k=g[0].link+"")&&O(E,k),T&1&&y!==(y=g[0].link)&&u(o,"href",y)},d(g){g&&n(c),g&&n(r),g&&n(h)}}}function fe(R){let c,r,h,s,l,w,a=R[0]&&ee(R);return{c(){c=d("main"),r=d("button"),h=D("Get A Random Meeting"),s=j(),a&&a.c(),this.h()},l(i){c=f(i,"MAIN",{});var m=M(c);r=f(m,"BUTTON",{class:!0});var b=M(r);h=N(b,"Get A Random Meeting"),b.forEach(n),s=z(m),a&&a.l(m),m.forEach(n),this.h()},h(){u(r,"class","button is-fullwidth svelte-1cf5j7t"),r.disabled=R[1],x(r,"is-loading",R[1])},m(i,m){C(i,c,m),e(c,r),e(r,h),e(c,s),a&&a.m(c,null),l||(w=se(r,"click",R[2]),l=!0)},p(i,[m]){m&2&&(r.disabled=i[1]),m&2&&x(r,"is-loading",i[1]),i[0]?a?a.p(i,m):(a=ee(i),a.c(),a.m(c,null)):a&&(a.d(1),a=null)},i:P,o:P,d(i){i&&n(c),a&&a.d(),l=!1,w()}}}function he(R,c,r){let h,s,l=[],w=!1,a=$();class i{constructor(t){this.name=t.meeting_name,this.startTime=this.getAdjustedStartTime(t),this.link=t.comments}getAdjustedStartTime(t){const p=parseInt(t.weekday_tinyint)===1?7:parseInt(t.weekday_tinyint)-1;let o=$().tz(t.time_zone||"UTC",!0).set({hour:parseInt(t.start_time.split(":")[0]),minute:parseInt(t.start_time.split(":")[1]),second:0}).isoWeekday(p);return o=o.clone().tz($.tz.guess()),$.tz($.tz.guess())>o&&o.add(1,"weeks"),o}}ae(()=>{I()});function m(_){const t=[];if(_)for(const p of _)t.push(new i(p));return t}function b(_){const t=_.length<3?_.length:3,p=[];let o=30;for(;_.length>p.length;){for(const k of _.filter(E=>!p.includes(E))){const E=$.tz($.tz.guess()),y=k.startTime.diff(E,"minutes");if(y>=-10&&y<=o&&(p.push(k),p.length>=t&&o>30))break}if(p.length>=t||o>1440)break;o+=15}return p}async function I(){r(1,w=!0);try{const p=await(await ne("https://bmlt.virtual-na.org/main_server/client_interface/jsonp/?switcher=GetSearchResults&data_field_key=weekday_tinyint,start_time,time_zone,meeting_name,comments")).json(),o=m(p);s=b(o),l=[],S(),r(1,w=!1)}catch(_){console.log("parsing failed",_)}}function S(){if($().diff(a,"seconds")>900){I(),a=$();return}l.length==s.length&&(l.length>1?l=[l.pop()]:l=[]);const _=s.filter(t=>!l.includes(t));r(0,h=_[Math.floor(Math.random()*_.length)]),l.push(h)}return[h,w,S]}class _e extends X{constructor(c){super();Y(this,c,he,fe,Z,{})}}function pe(R){let c,r,h,s,l,w,a,i,m,b,I,S,_,t,p,o,k,E,y,g,T,v,q,B;return t=new _e({}),{c(){c=d("link"),r=d("link"),h=d("meta"),s=d("meta"),l=d("script"),a=j(),i=d("section"),m=d("div"),b=d("div"),I=d("h4"),S=D("Random Virtual Meeting"),_=j(),re(t.$$.fragment),p=j(),o=d("div"),k=d("div"),E=d("p"),y=d("a"),g=D("Ideas?"),T=D(`
                \u2022 Meetings sourced from
                `),v=d("a"),q=D("virtual-na.org"),this.h()},l(A){const V=le('[data-svelte="svelte-1ouqje7"]',document.head);c=f(V,"LINK",{rel:!0,href:!0}),r=f(V,"LINK",{rel:!0,href:!0}),h=f(V,"META",{name:!0,content:!0}),s=f(V,"META",{name:!0,content:!0}),l=f(V,"SCRIPT",{src:!0,"data-auto-a11y":!0});var te=M(l);te.forEach(n),V.forEach(n),a=z(A),i=f(A,"SECTION",{class:!0});var L=M(i);m=f(L,"DIV",{class:!0});var U=M(m);b=f(U,"DIV",{class:!0});var G=M(b);I=f(G,"H4",{class:!0});var H=M(I);S=N(H,"Random Virtual Meeting"),H.forEach(n),_=z(G),ie(t.$$.fragment,G),G.forEach(n),U.forEach(n),p=z(L),o=f(L,"DIV",{class:!0});var J=M(o);k=f(J,"DIV",{class:!0});var W=M(k);E=f(W,"P",{});var K=M(E);y=f(K,"A",{href:!0,target:!0});var F=M(y);g=N(F,"Ideas?"),F.forEach(n),T=N(K,`
                \u2022 Meetings sourced from
                `),v=f(K,"A",{href:!0,target:!0});var Q=M(v);q=N(Q,"virtual-na.org"),Q.forEach(n),K.forEach(n),W.forEach(n),J.forEach(n),L.forEach(n),this.h()},h(){u(c,"rel","manifest"),u(c,"href","manifest.json"),u(r,"rel","apple-touch-icon"),u(r,"href","apple-icon-180.png"),u(h,"name","mobile-web-app-capable"),u(h,"content","yes"),u(s,"name","apple-mobile-web-app-capable"),u(s,"content","yes"),document.title="Random Virtual Meeting",oe(l.src,w="https://use.fontawesome.com/releases/v5.15.4/js/all.js")||u(l,"src",w),u(l,"data-auto-a11y","true"),u(I,"class","title is-4 has-text-centered"),u(b,"class","card p-5"),u(m,"class","container"),u(y,"href","https://github.com/bmlt-enabled/randomvm/issues"),u(y,"target","_blank"),u(v,"href","https://virtual-na.org/meetings"),u(v,"target","_blank"),u(k,"class","card p-5 mt-5 has-text-centered"),u(o,"class","container"),u(i,"class","section p-5")},m(A,V){e(document.head,c),e(document.head,r),e(document.head,h),e(document.head,s),e(document.head,l),C(A,a,V),C(A,i,V),e(i,m),e(m,b),e(b,I),e(I,S),e(b,_),ce(t,b,null),e(i,p),e(i,o),e(o,k),e(k,E),e(E,y),e(y,g),e(E,T),e(E,v),e(v,q),B=!0},p:P,i(A){B||(ue(t.$$.fragment,A),B=!0)},o(A){me(t.$$.fragment,A),B=!1},d(A){n(c),n(r),n(h),n(s),n(l),A&&n(a),A&&n(i),de(t)}}}class ve extends X{constructor(c){super();Y(this,c,null,pe,Z,{})}}export{ve as default};
