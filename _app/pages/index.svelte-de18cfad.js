import{S as W,i as F,s as Q,e as _,k as M,t as A,c as p,n as V,a as k,g as $,d as o,b as g,f as D,H as n,h as G,J as X,K as Z,I as O,A as x,L as ee,M as B,j as te,N as se,m as ae,O as ne,o as le,x as re,u as ie,v as oe}from"../chunks/vendor-40fbc9ca.js";function Y(I){let l,c,u,e,r,f=I[0].name+"",a,d,t,s,v=I[0].startTime.toString()+"",h,E,w,T,y,S=I[0].link+"",R,z;return{c(){l=_("br"),c=M(),u=_("div"),e=_("p"),r=_("b"),a=A(f),d=M(),t=_("br"),s=M(),h=A(v),E=M(),w=_("br"),T=M(),y=_("a"),R=A(S),this.h()},l(m){l=p(m,"BR",{}),c=V(m),u=p(m,"DIV",{class:!0});var i=k(u);e=p(i,"P",{class:!0});var b=k(e);r=p(b,"B",{});var C=k(r);a=$(C,f),C.forEach(o),d=V(b),t=p(b,"BR",{}),s=V(b),h=$(b,v),E=V(b),w=p(b,"BR",{}),T=V(b),y=p(b,"A",{href:!0});var j=k(y);R=$(j,S),j.forEach(o),b.forEach(o),i.forEach(o),this.h()},h(){g(y,"href",z=I[0].link),g(e,"class","title is-6"),g(u,"class","box is-shadowless has-text-centered m-0")},m(m,i){D(m,l,i),D(m,c,i),D(m,u,i),n(u,e),n(e,r),n(r,a),n(e,d),n(e,t),n(e,s),n(e,h),n(e,E),n(e,w),n(e,T),n(e,y),n(y,R)},p(m,i){i&1&&f!==(f=m[0].name+"")&&G(a,f),i&1&&v!==(v=m[0].startTime.toString()+"")&&G(h,v),i&1&&S!==(S=m[0].link+"")&&G(R,S),i&1&&z!==(z=m[0].link)&&g(y,"href",z)},d(m){m&&o(l),m&&o(c),m&&o(u)}}}function ce(I){let l,c,u,e,r,f,a=I[0]&&Y(I);return{c(){l=_("main"),c=_("button"),u=A("Get A Random Meeting"),e=M(),a&&a.c(),this.h()},l(d){l=p(d,"MAIN",{});var t=k(l);c=p(t,"BUTTON",{class:!0});var s=k(c);u=$(s,"Get A Random Meeting"),s.forEach(o),e=V(t),a&&a.l(t),t.forEach(o),this.h()},h(){g(c,"class","button is-fullwidth svelte-1cf5j7t"),c.disabled=I[1],X(c,"is-loading",I[1])},m(d,t){D(d,l,t),n(l,c),n(c,u),n(l,e),a&&a.m(l,null),r||(f=Z(c,"click",I[2]),r=!0)},p(d,[t]){t&2&&(c.disabled=d[1]),t&2&&X(c,"is-loading",d[1]),d[0]?a?a.p(d,t):(a=Y(d),a.c(),a.m(l,null)):a&&(a.d(1),a=null)},i:O,o:O,d(d){d&&o(l),a&&a.d(),r=!1,f()}}}function ue(I,l,c){let u,e,r=[],f=!1;class a{constructor(s){this.name=s.meeting_name,this.startTime=this.getAdjustedStartTime(s),this.link=s.comments}getAdjustedStartTime(s){const v=parseInt(s.weekday_tinyint)===1?7:parseInt(s.weekday_tinyint)-1;let h=B().tz(s.time_zone||"UTC",!0).set({hour:parseInt(s.start_time.split(":")[0]),minute:parseInt(s.start_time.split(":")[1]),second:0}).isoWeekday(v);return h=h.clone().tz(B.tz.guess()),B.tz(B.tz.guess())>h&&h.add(1,"weeks"),h}}x(()=>{c(1,f=!0),ee("https://bmlt.virtual-na.org/main_server/client_interface/jsonp/?switcher=GetSearchResults&data_field_key=weekday_tinyint,start_time,time_zone,meeting_name,comments").then(t=>t.json()).then(t=>{let s=[];if(t)for(const v of t)s.push(new a(v));return s}).then(t=>{if(e=[],!t)return;const s=t.length<3?t.length:3;let v=30;for(;;){for(const h of t.filter(E=>!e.includes(E))){const E=B.tz(B.tz.guess()),w=h.startTime.diff(E,"minutes");if(w>=0&&w<=v&&(e.push(h),e.length>=s&&v>30))break}if(e.length>=s||v>1440)break;v+=15}}).then(()=>d()).then(()=>c(1,f=!1)).catch(t=>console.log("parsing failed",t))});function d(){console.log("hi"),console.log(r.length),console.log(e.length),r.length==e.length&&(r.length>1?r=[r.pop()]:r=[]);const t=e.filter(s=>!r.includes(s));c(0,u=t[Math.floor(Math.random()*t.length)]),r.push(u),console.log(u.name),console.log(u.startTime.toString()),console.log(u.link)}return[u,f,d]}class de extends W{constructor(l){super();F(this,l,ue,ce,Q,{})}}function fe(I){let l,c,u,e,r,f,a,d,t,s,v,h,E,w,T,y,S,R,z,m;return s=new de({}),{c(){l=_("script"),u=M(),e=_("section"),r=_("div"),f=_("div"),a=_("h4"),d=A("Random Virtual Meeting"),t=M(),te(s.$$.fragment),v=M(),h=_("div"),E=_("div"),w=_("p"),T=_("a"),y=A("Ideas?"),S=A(`
                \u2022 Meetings sourced from
                `),R=_("a"),z=A("virtual-na.org"),this.h()},l(i){const b=se('[data-svelte="svelte-1jtem2v"]',document.head);l=p(b,"SCRIPT",{src:!0,"data-auto-a11y":!0});var C=k(l);C.forEach(o),b.forEach(o),u=V(i),e=p(i,"SECTION",{class:!0});var j=k(e);r=p(j,"DIV",{class:!0});var P=k(r);f=p(P,"DIV",{class:!0});var N=k(f);a=p(N,"H4",{class:!0});var U=k(a);d=$(U,"Random Virtual Meeting"),U.forEach(o),t=V(N),ae(s.$$.fragment,N),N.forEach(o),P.forEach(o),v=V(j),h=p(j,"DIV",{class:!0});var H=k(h);E=p(H,"DIV",{class:!0});var J=k(E);w=p(J,"P",{});var q=k(w);T=p(q,"A",{href:!0,target:!0});var L=k(T);y=$(L,"Ideas?"),L.forEach(o),S=$(q,`
                \u2022 Meetings sourced from
                `),R=p(q,"A",{href:!0,target:!0});var K=k(R);z=$(K,"virtual-na.org"),K.forEach(o),q.forEach(o),J.forEach(o),H.forEach(o),j.forEach(o),this.h()},h(){document.title="Random Virtual Meeting",ne(l.src,c="https://use.fontawesome.com/releases/v5.15.4/js/all.js")||g(l,"src",c),g(l,"data-auto-a11y","true"),g(a,"class","title is-4 has-text-centered"),g(f,"class","card p-5"),g(r,"class","container"),g(T,"href","https://github.com/bmlt-enabled/randomvm/issues"),g(T,"target","_blank"),g(R,"href","https://virtual-na.org/meetings"),g(R,"target","_blank"),g(E,"class","card p-5 mt-5 has-text-centered"),g(h,"class","container"),g(e,"class","section p-5")},m(i,b){n(document.head,l),D(i,u,b),D(i,e,b),n(e,r),n(r,f),n(f,a),n(a,d),n(f,t),le(s,f,null),n(e,v),n(e,h),n(h,E),n(E,w),n(w,T),n(T,y),n(w,S),n(w,R),n(R,z),m=!0},p:O,i(i){m||(re(s.$$.fragment,i),m=!0)},o(i){ie(s.$$.fragment,i),m=!1},d(i){o(l),i&&o(u),i&&o(e),oe(s)}}}class he extends W{constructor(l){super();F(this,l,null,fe,Q,{})}}export{he as default};
